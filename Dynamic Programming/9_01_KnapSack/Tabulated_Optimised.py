# CODE 9d: Optimization of tabulated 0-1 Knapsack problem

def knapsack(max_capacity: int,  # Time Complexity: O(n * max_weight)  Space Complexity: O(max_weight)
             weights: list[int], values: list[int]) -> int:
    table = [0] * (max_capacity + 1)
    for i in range(1, len(weights) + 1):
        for capacity in range(max_capacity, 0, -1):
            if weights[i - 1] <= capacity:
                table[capacity] = max(table[capacity], table[capacity - weights[i - 1]] + values[i - 1])
    return table[max_capacity]


print(knapsack(50, [10, 20, 30], [60, 100, 120]))  # 220
print(knapsack(10, [12, 13, 15, 20], [10, 20, 30, 40]))  # 0
print(knapsack(841,
               [4, 4, 5, 2, 2, 4, 9, 8, 5, 3, 8, 8, 10, 4, 2, 10, 9, 7, 6, 1, 3, 9, 7, 1, 3, 5, 9, 7, 6, 1, 10, 1, 1, 7,
                2, 4, 9, 10, 4, 5, 5, 7],
               [468, 335, 501, 170, 725, 479, 359, 963, 465, 706, 146, 282, 828, 962, 492, 996, 943, 828, 437, 392, 605,
                903, 154, 293, 383, 422, 717, 719, 896, 448, 727, 772, 539, 870, 913, 668, 300, 36, 895, 704, 812,
                323]))  # 24576

print(knapsack(8,
               [8, 9, 10, 5, 2, 6, 7, 7, 7, 7, 7, 8, 2, 5, 1, 7, 2, 3, 2, 5, 10, 6, 3, 4, 5, 2, 6, 3, 4, 2, 7, 9, 9, 3,
                8, 8, 2, 3, 7, 1, 5, 10, 5, 7, 1, 4, 7, 3, 5, 6, 9, 9, 2, 3, 2, 5, 10, 9, 3, 5, 6, 3, 10, 10, 9, 4, 9,
                7, 10, 9, 7, 7, 3, 4, 9, 3, 7, 3, 8, 6, 8, 9, 3],
               [42, 468, 335, 501, 170, 725, 479, 359, 963, 465, 706, 146, 282, 828, 962, 492, 996, 943, 828, 437, 392,
                605, 903, 154, 293, 383, 422, 717, 719, 896, 448, 727, 772, 539, 870, 913, 668, 300, 36, 895, 704, 812,
                323, 334, 674, 665, 142, 712, 254, 869, 548, 645, 663, 758, 38, 860, 724, 742, 530, 779, 317, 36, 191,
                843, 289, 107, 41, 943, 265, 649, 447, 806, 891, 730, 371, 351, 7, 102, 394, 549, 630, 624, 85, 955,
                757, 841, 967, 377, 932, 309, 945, 440, 627, 324, 538, 539, 119, 83, 930, 542, 834, 116, 640, 659, 705,
                931, 978, 307, 674, 387, 22, 746, 925, 73, 271, 830, 778, 574, 98, 513, 987, 291, 162, 637, 356, 768,
                656, 575, 32, 53, 351, 151, 942, 725, 967, 431, 108, 192, 8, 338, 458, 288, 754, 384, 946, 910, 210,
                759, 222, 589, 423, 947, 507, 31, 414, 169, 901, 592, 763, 656, 411, 360, 625, 538, 549, 484, 596, 42,
                603, 351, 292, 837, 375, 21, 597, 22, 349, 200, 669, 485, 282, 735, 54, 1000, 419, 939, 901, 789, 128,
                468, 729, 894, 649, 484, 808, 422, 311, 618, 814, 515, 310, 617, 936, 452, 601, 250, 520, 557, 799, 304,
                225, 9, 845, 610, 990, 703, 196, 486, 94, 344, 524, 588, 315, 504, 449, 201, 459, 619, 581, 797, 799,
                282, 590, 799, 10, 158, 473, 623, 539, 293, 39, 180, 191, 658, 959, 192, 816, 889, 157, 512, 203, 635,
                273, 56, 329, 647, 363, 887, 876, 434, 870, 143, 845, 417, 882, 999, 323, 652, 22, 700, 558, 477, 893,
                390, 76, 713, 601, 511, 4, 870, 862, 689, 402, 790, 256, 424, 3, 586, 183, 286, 89, 427, 618, 758, 833,
                933, 170, 155, 722, 190, 977, 330, 369, 693, 426, 556, 435, 550, 442, 513, 146, 61, 719, 754, 140, 424,
                280, 997, 688, 530, 550, 438, 867, 950, 194, 196, 298, 417, 287, 106, 489, 283, 456, 735, 115, 702, 317,
                672, 787, 264, 314, 356, 186, 54, 913, 809, 833, 946, 314, 757, 322, 559, 647, 983, 482, 145, 197, 223,
                130, 162, 536, 451, 174, 467, 45, 660, 293, 440, 254, 25, 155, 511, 746, 650, 187, 314, 475, 23, 169,
                19, 788, 906, 959, 392, 203, 626, 478, 415, 315, 825, 335, 875, 373, 160, 834, 71, 488, 298, 519, 178,
                774, 271, 764, 669, 193, 986, 103, 481, 214, 628, 803, 100, 528, 626, 544, 925, 24, 973, 62, 182, 4,
                433, 506, 594, 726, 32, 493, 143, 223, 287, 65, 901, 188, 361, 414, 975, 271, 171, 236, 834, 712, 761,
                897, 668, 286, 551, 141, 695, 696, 625, 20, 126, 577, 695, 659, 303, 372, 467, 679, 594, 852, 485, 19,
                465, 120, 153, 801, 88, 61, 927, 11, 758, 171, 316, 577, 228, 44, 759, 165, 110, 883, 87, 566, 488, 578,
                475, 626, 628, 630, 929, 424, 521, 903, 963, 124, 597, 738, 262, 196, 526, 265, 261, 203, 117, 31, 327,
                12, 772, 412, 548, 154, 521, 791, 925, 189, 764, 941, 852, 663, 830, 901, 714, 959, 579, 366, 8, 478,
                201, 59, 440, 304, 761, 358, 325, 478, 109, 114, 888, 802, 851, 461, 429, 994, 385, 406, 541, 112, 705,
                836, 357, 73, 351, 824, 486, 557, 217, 627, 358, 527, 358, 338, 272, 870, 362, 897, 23, 618, 113, 718,
                697, 586, 42, 424, 130, 230, 566, 560, 933, 297, 856, 54, 963, 585, 735, 655, 973, 458, 370, 533, 964,
                608, 484, 912, 636, 68, 849, 676, 939, 224, 143, 755, 512, 742, 176, 460, 826, 222, 871, 627, 935, 206,
                784, 851, 399, 280, 702, 194, 735, 638, 535, 557, 994, 177, 706, 963, 549, 882, 301, 414, 642, 856, 856,
                143, 463, 612, 878, 425, 679, 753, 444, 297, 674, 41, 314, 876, 73, 819, 611, 18, 933, 113, 696, 170,
                832, 41, 489, 686, 91, 498, 590, 991, 146, 354, 315, 652, 741, 45, 259, 336, 760, 193, 606, 265, 182,
                504, 830, 776, 609, 293, 998, 550, 557, 562, 628, 468, 542, 130, 241, 814, 175, 602, 78, 216, 684, 214,
                993, 825, 602, 393, 760, 671, 429, 28, 85, 76, 787, 499, 971, 288, 848, 605, 504, 222, 664, 707, 364,
                11, 172, 490, 241, 165, 543, 620, 914, 592, 705, 819, 233, 751, 206, 976, 540, 304, 423, 99, 248, 585,
                649, 972, 865, 914, 76, 546, 713, 547, 679, 770, 263, 520, 986, 290, 945, 866, 541, 246, 509, 319, 871,
                602, 324, 133, 473, 153, 88, 571, 764, 902, 104, 424, 528, 601, 970, 16, 566, 29, 544, 348, 89, 944,
                638, 410, 464, 50, 682, 589, 343, 609, 61, 222, 759, 955, 889, 147, 691, 950, 844, 431, 621, 749, 68,
                537, 784, 36, 227, 186, 39, 854, 630, 225, 749, 924, 360, 258, 767, 945, 956, 319, 727, 412, 26, 356, 2,
                550, 497, 585, 516, 965, 343, 76, 914, 143, 197, 949, 73, 427, 607, 174, 430, 405, 706, 627, 813, 376,
                94, 566, 37, 737, 142, 815, 995, 257, 653, 937, 839, 483, 356, 16, 132, 231, 842, 626, 12, 638, 187,
                691, 651, 663, 635, 894, 354, 417, 453, 9, 263, 234, 455, 304, 635, 304, 257, 149, 125, 318, 214, 110,
                29, 201, 81, 319, 859, 51, 156, 362, 265, 904, 677, 644, 910, 903, 562, 490, 949, 283, 654, 675, 221,
                403, 924, 832, 370, 879, 260, 9, 620, 972, 4, 946, 782, 505, 393, 686, 314, 699, 590, 723, 939, 38,
                411, 462, 235, 509, 962, 960, 494, 516, 270, 938, 870, 59, 701, 972, 265, 118, 216, 556, 816, 331, 40,
                213, 289, 83, 955, 86, 711, 485, 775, 381, 816, 952, 542, 116, 680, 111, 899, 74, 789, 978, 133, 957,
                690, 114, 9, 942, 791, 724, 364, 29, 185, 779, 201, 72, 886, 975, 72, 334, 868, 154, 296, 169, 826, 677,
                630, 651, 599, 310, 694, 687, 81, 117, 250]))  # 4577

print(knapsack(609,
               [8, 9, 10, 5, 2, 6, 7, 7, 7, 7, 7, 8, 2, 5, 1, 7, 2, 3, 2, 5, 10, 6, 3, 4, 5, 2, 6, 3, 4, 2, 7, 9, 9, 3,
                8, 8, 2, 3, 7, 1, 5, 10, 5, 7, 1, 4, 7, 3, 5, 6, 9, 9, 2, 3, 2, 5, 10, 9, 3, 5, 6, 3, 10, 10, 9, 4, 9,
                7, 10, 9, 7, 7, 3, 4, 9, 3, 7, 3, 8, 6, 8, 9, 3, 8, 9, 1, 3, 1, 9, 10, 3, 9, 3, 1, 6, 6, 3, 8, 7, 8, 9,
                8, 9, 2, 7, 1, 10, 6, 9, 10, 1, 1, 1, 8, 3, 6, 6, 3, 2, 5, 9, 7, 5, 7, 9, 10, 9, 4, 6, 6, 2, 6, 6, 9, 5,
                1, 6, 5, 8, 3, 2, 5, 10, 10, 1, 4, 1, 4, 6, 1, 8, 7, 8, 9, 4, 7, 5, 5, 2, 10, 6, 6, 8, 5, 8, 4, 5, 1, 9,
                9, 2, 6, 3, 4, 3, 5, 7, 7, 7, 3, 10, 1, 5, 10, 4, 2, 2, 10, 10, 6, 6, 6, 7, 1, 6, 10, 5, 7, 4, 5, 10, 1,
                6, 4, 10, 2, 3, 9, 9, 2, 9, 7, 1, 3, 5, 10, 1, 3, 3, 2, 6, 5, 5, 5, 3, 6, 1, 5, 3, 2, 3, 8, 8, 10, 6, 6,
                5, 1, 4, 5, 2, 3, 3, 10, 9, 3, 3, 8, 9, 6, 9, 4, 10, 5, 5, 7, 10, 9, 6, 7, 7, 1, 8, 3, 8, 3, 7, 5, 8, 2,
                4, 3, 2, 7, 4, 9, 4, 3, 9, 7, 1, 2, 3, 7, 1, 6, 5, 7, 8, 10, 4, 5, 8, 9, 9, 2, 7, 4, 9, 8, 7, 2, 8, 3,
                4, 8, 9, 6, 9, 6, 9, 8, 4, 4, 2, 1, 9, 2, 1, 10, 3, 5, 10, 2, 6, 8, 4, 4, 5, 3, 3, 1, 2, 3, 8, 8, 1, 3,
                5, 2, 1, 4, 8, 4, 10, 6, 10, 8, 3, 1, 3, 9, 7, 8, 1, 9, 2, 9, 4, 1, 4, 7, 3, 1, 3, 9, 5, 2, 9, 4, 8, 6,
                9, 2, 8, 1, 5, 9, 9, 2, 4, 7, 8, 9, 10, 6, 6, 6, 7, 7, 4, 1, 1, 9, 9, 3, 4, 1, 7, 6, 1, 10, 8, 3, 3, 9,
                3, 10, 5, 5, 9, 3, 8, 3, 6, 9, 5, 8, 4, 10, 6, 2, 10, 1, 3, 9, 4, 2, 5, 4, 2, 1, 5, 1, 8, 10, 1, 9, 2,
                5, 1, 8, 10, 6, 4, 9, 3, 4, 3, 2, 1, 5, 1, 8, 6, 10, 1, 6, 2, 3, 1, 10, 9, 10, 2, 8, 4, 4, 1, 8, 7, 7,
                1, 3, 9, 10, 9, 10, 10, 10, 5, 3, 1, 9, 8, 9, 8, 4, 1, 8, 7, 5, 3, 2, 10, 2, 7, 1, 4, 4, 7, 3, 3, 2, 5,
                4, 3, 7, 1, 6, 5, 10, 7, 1, 9, 3, 8, 5, 1, 8, 7, 1, 2, 3, 10, 4, 9, 6, 2, 6, 7, 7, 9, 9, 10, 9, 8, 1, 8,
                10, 2, 6, 9, 7, 4, 10, 5, 6, 4, 9, 3, 4, 10, 5, 9, 6, 2, 4, 3, 9, 2, 7, 5, 7, 8, 8, 10, 7, 5, 2, 10, 3,
                7, 4, 2, 6, 10, 8, 1, 3, 7, 2, 8, 7, 3, 6, 4, 5, 1, 8, 6, 6, 4, 2, 9, 9, 9, 1, 2, 8, 6, 1, 6, 10, 1, 10,
                4, 6, 5, 3, 8, 3, 7, 8, 3, 3, 1, 2, 2, 8, 6, 10, 2, 9, 2, 8, 9, 7, 7, 10, 10, 3, 7, 7, 6, 9, 5, 1, 4, 8,
                9, 4, 2, 2, 3, 6, 8, 7, 3, 2, 7, 2, 2, 6, 8, 5, 9, 6, 7, 5, 10, 9, 5, 4, 3, 6, 4, 9, 4, 3, 8, 1, 7, 9,
                1, 2, 2, 10, 6, 4, 7, 4, 2, 6, 4, 5, 1, 4, 2, 8, 10, 1, 4, 6, 3, 10, 2, 3, 7, 2, 8, 1, 2, 6, 3, 3, 10,
                1, 6, 2, 9, 4, 7, 9, 9, 7, 2, 7, 7, 8, 1, 5, 10, 9, 10, 5, 10, 9, 8, 6, 7, 5, 9, 7, 9, 8, 9, 1, 10, 6,
                7, 10, 1, 1, 2, 4, 6, 6, 9, 1, 2, 8, 8, 5, 7, 8, 1, 8, 5, 2, 3, 2, 9, 4, 6, 8, 2, 5, 8, 7, 9, 3, 4, 1,
                3, 8, 9, 9, 6, 10, 8, 2, 4, 5, 8, 2, 4, 8, 2, 3, 8, 6, 4, 5, 5, 6, 6, 2, 5, 2, 3, 7, 7, 4, 4, 1, 1, 9,
                2, 4, 9, 2, 7, 10, 9, 1, 2, 4, 10, 4, 10, 4, 7, 6, 6, 5, 1, 6, 1, 7, 6, 6, 2, 9, 10, 7, 3, 3, 6, 1, 6,
                3, 6, 3, 1, 7, 8, 3, 9, 1, 1, 7, 9, 4, 1, 7, 5, 4, 8, 1, 6, 3, 1, 8, 6, 7, 2, 9, 2, 9, 6, 7, 6, 10, 3,
                7, 6, 3, 4, 3, 2, 3, 3, 9, 9, 9, 8, 5, 1, 1, 6, 10, 10, 6, 4, 1, 10, 10, 6, 2, 2, 2, 3, 4, 4, 10, 8, 3,
                4, 4, 1, 5, 9, 5, 4, 10, 3, 5, 10, 1, 6, 8, 5, 8, 7, 7, 4, 1, 10, 1, 9, 1, 2, 6, 2, 1, 4, 10, 6, 9, 10,
                7, 3, 6, 8, 7, 4, 9, 6, 10, 4, 1, 3, 6, 2, 6, 8, 8, 10, 5, 2, 8, 9, 6, 8, 9, 9, 5, 3, 4, 9, 5, 2, 4, 1,
                5, 2, 8, 8, 3, 2, 4, 2, 4, 2, 6, 2, 6, 1, 6, 2, 3, 3, 2, 6, 6, 4, 9, 10, 3],
               [42, 468, 335, 501, 170, 725, 479, 359, 963, 465, 706, 146, 282, 828, 962, 492, 996, 943, 828, 437, 392,
                605, 903, 154, 293, 383, 422, 717, 719, 896, 448, 727, 772, 539, 870, 913, 668, 300, 36, 895, 704, 812,
                323, 334, 674, 665, 142, 712, 254, 869, 548, 645, 663, 758, 38, 860, 724, 742, 530, 779, 317, 36, 191,
                843, 289, 107, 41, 943, 265, 649, 447, 806, 891, 730, 371, 351, 7, 102, 394, 549, 630, 624, 85, 955,
                757, 841, 967, 377, 932, 309, 945, 440, 627, 324, 538, 539, 119, 83, 930, 542, 834, 116, 640, 659, 705,
                931, 978, 307, 674, 387, 22, 746, 925, 73, 271, 830, 778, 574, 98, 513, 987, 291, 162, 637, 356, 768,
                656, 575, 32, 53, 351, 151, 942, 725, 967, 431, 108, 192, 8, 338, 458, 288, 754, 384, 946, 910, 210,
                759, 222, 589, 423, 947, 507, 31, 414, 169, 901, 592, 763, 656, 411, 360, 625, 538, 549, 484, 596, 42,
                603, 351, 292, 837, 375, 21, 597, 22, 349, 200, 669, 485, 282, 735, 54, 1000, 419, 939, 901, 789, 128,
                468, 729, 894, 649, 484, 808, 422, 311, 618, 814, 515, 310, 617, 936, 452, 601, 250, 520, 557, 799, 304,
                225, 9, 845, 610, 990, 703, 196, 486, 94, 344, 524, 588, 315, 504, 449, 201, 459, 619, 581, 797, 799,
                282, 590, 799, 10, 158, 473, 623, 539, 293, 39, 180, 191, 658, 959, 192, 816, 889, 157, 512, 203, 635,
                273, 56, 329, 647, 363, 887, 876, 434, 870, 143, 845, 417, 882, 999, 323, 652, 22, 700, 558, 477, 893,
                390, 76, 713, 601, 511, 4, 870, 862, 689, 402, 790, 256, 424, 3, 586, 183, 286, 89, 427, 618, 758, 833,
                933, 170, 155, 722, 190, 977, 330, 369, 693, 426, 556, 435, 550, 442, 513, 146, 61, 719, 754, 140, 424,
                280, 997, 688, 530, 550, 438, 867, 950, 194, 196, 298, 417, 287, 106, 489, 283, 456, 735, 115, 702, 317,
                672, 787, 264, 314, 356, 186, 54, 913, 809, 833, 946, 314, 757, 322, 559, 647, 983, 482, 145, 197, 223,
                130, 162, 536, 451, 174, 467, 45, 660, 293, 440, 254, 25, 155, 511, 746, 650, 187, 314, 475, 23, 169,
                19, 788, 906, 959, 392, 203, 626, 478, 415, 315, 825, 335, 875, 373, 160, 834, 71, 488, 298, 519, 178,
                774, 271, 764, 669, 193, 986, 103, 481, 214, 628, 803, 100, 528, 626, 544, 925, 24, 973, 62, 182, 4,
                433, 506, 594, 726, 32, 493, 143, 223, 287, 65, 901, 188, 361, 414, 975, 271, 171, 236, 834, 712, 761,
                897, 668, 286, 551, 141, 695, 696, 625, 20, 126, 577, 695, 659, 303, 372, 467, 679, 594, 852, 485, 19,
                465, 120, 153, 801, 88, 61, 927, 11, 758, 171, 316, 577, 228, 44, 759, 165, 110, 883, 87, 566, 488, 578,
                475, 626, 628, 630, 929, 424, 521, 903, 963, 124, 597, 738, 262, 196, 526, 265, 261, 203, 117, 31, 327,
                12, 772, 412, 548, 154, 521, 791, 925, 189, 764, 941, 852, 663, 830, 901, 714, 959, 579, 366, 8, 478,
                201, 59, 440, 304, 761, 358, 325, 478, 109, 114, 888, 802, 851, 461, 429, 994, 385, 406, 541, 112, 705,
                836, 357, 73, 351, 824, 486, 557, 217, 627, 358, 527, 358, 338, 272, 870, 362, 897, 23, 618, 113, 718,
                697, 586, 42, 424, 130, 230, 566, 560, 933, 297, 856, 54, 963, 585, 735, 655, 973, 458, 370, 533, 964,
                608, 484, 912, 636, 68, 849, 676, 939, 224, 143, 755, 512, 742, 176, 460, 826, 222, 871, 627, 935, 206,
                784, 851, 399, 280, 702, 194, 735, 638, 535, 557, 994, 177, 706, 963, 549, 882, 301, 414, 642, 856, 856,
                143, 463, 612, 878, 425, 679, 753, 444, 297, 674, 41, 314, 876, 73, 819, 611, 18, 933, 113, 696, 170,
                832, 41, 489, 686, 91, 498, 590, 991, 146, 354, 315, 652, 741, 45, 259, 336, 760, 193, 606, 265, 182,
                504, 830, 776, 609, 293, 998, 550, 557, 562, 628, 468, 542, 130, 241, 814, 175, 602, 78, 216, 684, 214,
                993, 825, 602, 393, 760, 671, 429, 28, 85, 76, 787, 499, 971, 288, 848, 605, 504, 222, 664, 707, 364,
                11, 172, 490, 241, 165, 543, 620, 914, 592, 705, 819, 233, 751, 206, 976, 540, 304, 423, 99, 248, 585,
                649, 972, 865, 914, 76, 546, 713, 547, 679, 770, 263, 520, 986, 290, 945, 866, 541, 246, 509, 319, 871,
                602, 324, 133, 473, 153, 88, 571, 764, 902, 104, 424, 528, 601, 970, 16, 566, 29, 544, 348, 89, 944,
                638, 410, 464, 50, 682, 589, 343, 609, 61, 222, 759, 955, 889, 147, 691, 950, 844, 431, 621, 749, 68,
                537, 784, 36, 227, 186, 39, 854, 630, 225, 749, 924, 360, 258, 767, 945, 956, 319, 727, 412, 26, 356, 2,
                550, 497, 585, 516, 965, 343, 76, 914, 143, 197, 949, 73, 427, 607, 174, 430, 405, 706, 627, 813, 376,
                94, 566, 37, 737, 142, 815, 995, 257, 653, 937, 839, 483, 356, 16, 132, 231, 842, 626, 12, 638, 187,
                691, 651, 663, 635, 894, 354, 417, 453, 9, 263, 234, 455, 304, 635, 304, 257, 149, 125, 318, 214, 110,
                29, 201, 81, 319, 859, 51, 156, 362, 265, 904, 677, 644, 910, 903, 562, 490, 949, 283, 654, 675, 221,
                403, 924, 832, 370, 879, 260, 9, 620, 972, 4, 946, 782, 505, 393, 686, 314, 699, 590, 723, 939, 38, 411,
                462, 235, 509, 962, 960, 494, 516, 270, 938, 870, 59, 701, 972, 265, 118, 216, 556, 816, 331, 40, 213,
                289, 83, 955, 86, 711, 485, 775, 381, 816, 952, 542, 116, 680, 111, 899, 74, 789, 978, 133, 957, 690,
                114, 9, 942, 791, 724, 364, 29, 185, 779, 201, 72, 886, 975, 72, 334, 868, 154, 296, 169, 826, 677, 630,
                651, 599, 310, 694, 687, 81, 117, 250]))  # 181631
